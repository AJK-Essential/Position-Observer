<style>
  html,
  body {
    height: 100%;
    width: 100%;
    overflow: hidden;
    margin: 0;
    padding: 0;
    position: relative;
    background-color: rgb(3, 27, 37);
  }
  .target {
    background-color: rgba(128, 0, 0, 0.361);
    width: 20px;
    height: 20px;
    /* transition: all 0.2s ease-in-out; */
    border-radius: 4px;
  }
  .overlay {
    position: fixed;
    width: 100px;
    height: 100px;
    background-color: rgba(0, 0, 0, 0.2);
    border-radius: 8px;
    color: rgba(255, 255, 255, 0.4);
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
      Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue",
      sans-serif;
    font-size: 0.75rem;
    display: grid;
    place-items: center;
    text-align: center;
    padding: 0.5rem;
  }
  .data {
    color: wheat;
    position: absolute;
    bottom: 0px;
    width: 100%;
  }
  .scroller::-webkit-scrollbar {
    appearance: none;
  }
  .scroller::-webkit-scrollbar-track {
    width: 0.25rem;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 8px;
  }
  .scroller::-webkit-scrollbar-thumb {
    background: rgb(0, 0, 0);
    border-radius: 8px;
    width: 0.25rem;
  }
  .scroller::-webkit-scrollbar-corner {
    appearance: none;
  }
  .root-bounds {
    position: fixed;
    bottom: 0;
    right: 0;
    width: 150px;
    height: 150px;
    border: 1px solid gold;
    box-sizing: border-box;
    pointer-events: none;
  }
</style>

<div class="scroller" style="height: 70%; overflow: auto">
  <div
    style="
      height: 800px;
      width: 800px;
      display: flex;
      justify-content: center;
      align-items: center;
    "
  >
    <div class="target"></div>
  </div>
</div>
<div class="overlay">
  This overlay tracks the maroon target.<br /><span style="font-size: smaller"
    >The yellow border represents the capturing window</span
  >
</div>
<div class="root-bounds"></div>
<pre class="data"></pre>
<script>
  const target = document.querySelector(".target");
  const overlay = document.querySelector(".overlay");
  const code = document.querySelector(".data");
  const scroller = document.querySelector(".scroller");
  const rootBoundsDiv = document.querySelector(".root-bounds");
</script>
<script type="module">
  import { PositionObserver } from "./position-observer.js";

  const positionObs = new PositionObserver(posObsCallback);
  positionObs.observe(target);

  function posObsCallback(data) {
    overlay.style.top = data.y + target.getBoundingClientRect().height + "px";
    overlay.style.left = data.x + "px";
    code.innerHTML = `
  Data.x              =   ${parseFloat(data.x).toFixed(2)};
  Data.y              =   ${parseFloat(data.y).toFixed(2)};
  Data.outOfViewport  =   ${data.outOfViewport}`;
    rootBoundsDiv.style.top = data.rootBounds.top + "px";
    rootBoundsDiv.style.left = data.rootBounds.left + "px";
    rootBoundsDiv.style.width = data.rootBounds.width + "px";
    rootBoundsDiv.style.height = data.rootBounds.height + "px";
    console.log("posObsCallback called");
  }

  scroller.scrollTop = 353;
  scroller.scrollLeft = 318;
</script>
